<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Ministérios</title>
    <style>
        :root {
            --primary-light: #D7CCC8;
            --primary: #A1887F;
            --primary-dark: #8D6E63;
            --accent: #5D4037;
            --text-light: #EFEBE9;
            --text-dark: #3E2723;
            --background: #F5F5F6;
        }

        * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: var(--background); color: var(--text-dark); line-height:1.6; }
        .container { max-width:1200px; margin:0 auto; padding:20px; }
        header { background-color: var(--primary); color: var(--text-light); padding:20px 0; border-bottom:3px solid var(--primary-dark); }
        .header-content { display:flex; justify-content:space-between; align-items:center; }
        .logo { font-size:24px; font-weight:bold; }
        nav ul { display:flex; list-style:none; }
        nav ul li { margin-left:20px; }
        nav ul li a { color: var(--text-light); text-decoration:none; padding:5px 10px; border-radius:4px; transition:0.3s; }
        nav ul li a:hover { background-color: var(--primary-dark); }
        h1,h2,h3,h4 { margin-bottom:15px; }
        .main-title { text-align:center; margin:30px 0; color: var(--accent); }
        form { margin: 20px 0; background-color:white; padding:20px; border-radius:8px; box-shadow:0 4px 6px rgba(0,0,0,0.1); }
        form input { padding:10px; margin-right:10px; margin-bottom:10px; width: calc(50% - 20px); }
        form button { padding:10px 15px; background-color:var(--primary); color:var(--text-light); border:none; border-radius:4px; cursor:pointer; }
        form button:hover { background-color: var(--primary-dark); }
        .list-section { margin-bottom:40px; }
        .list-section h2 { background-color: var(--primary-light); padding:10px 15px; border-left:5px solid var(--accent); color: var(--accent); margin-bottom:10px; }
        ul { list-style:none; padding-left:0; }
        ul li { padding:8px; background:white; margin-bottom:5px; border-radius:5px; box-shadow:0 2px 4px rgba(0,0,0,0.05); }
        footer { background-color: var(--primary-dark); color: var(--text-light); text-align:center; padding:20px 0; margin-top:40px; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">Sistema de Gestão de Ministérios</div>
                <nav>
                    <ul>
                        <li><a href="#usuarios">Usuários</a></li>
                        <li><a href="#eventos">Eventos</a></li>
                        <li><a href="#escalas">Escalas</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="container">
        <h1 class="main-title">Sistema de Gerenciamento de Ministérios e Eventos</h1>

        <!-- FORMULÁRIO PARA INSCRIÇÃO EM EVENTO -->
        <form id="formInscricao">
            <h2>Inscrever Usuário em Evento</h2>
            <input type="number" placeholder="ID do usuário" id="id_usuario" required>
            <input type="number" placeholder="ID do evento" id="id_evento" required>
            <button type="submit">Inscrever</button>
        </form>

        <!-- LISTA DE USUÁRIOS -->
        <section class="list-section" id="usuarios">
            <h2>Lista de Usuários</h2>
            <ul id="listaUsuarios"></ul>
        </section>

        <!-- LISTA DE EVENTOS -->
        <section class="list-section" id="eventos">
            <h2>Lista de Eventos</h2>
            <ul id="listaEventos"></ul>
        </section>

        <!-- LISTA DE ESCALAS -->
        <section class="list-section" id="escalas">
            <h2>Lista de Escalas</h2>
            <ul id="listaEscalas"></ul>
        </section>
    </div>

    <footer>
        <div class="container">
            <p>Sistema de Gestão de Ministérios &copy; 2025 - Todos os direitos reservados</p>
        </div>
    </footer>

    <script>
        // FUNÇÃO PARA LISTAR USUÁRIOS
        function listarUsuarios() {
            fetch('http://localhost:3000/usuarios')
                .then(res => res.json())
                .then(data => {
                    const lista = document.getElementById('listaUsuarios');
                    lista.innerHTML = '';
                    data.forEach(u => {
                        const li = document.createElement('li');
                        li.textContent = `${u.id_usuario} - ${u.nome} (${u.email})`;
                        lista.appendChild(li);
                    });
                });
        }

        // FUNÇÃO PARA LISTAR EVENTOS
        function listarEventos() {
            fetch('http://localhost:3000/eventos')
                .then(res => res.json())
                .then(data => {
                    const lista = document.getElementById('listaEventos');
                    lista.innerHTML = '';
                    data.forEach(e => {
                        const li = document.createElement('li');
                        li.textContent = `${e.id_evento} - ${e.nome} | ${e.data_evento} ${e.horario}`;
                        lista.appendChild(li);
                    });
                });
        }

        // FUNÇÃO PARA LISTAR ESCALAS
        function listarEscalas() {
            fetch('http://localhost:3000/escalas')
                .then(res => res.json())
                .then(data => {
                    const lista = document.getElementById('listaEscalas');
                    lista.innerHTML = '';
                    data.forEach(s => {
                        const li = document.createElement('li');
                        li.textContent = `${s.id_escala} - ${s.data_escala} | Observações: ${s.observacoes}`;
                        lista.appendChild(li);
                    });
                });
        }

        // EXECUTAR LISTAGENS AO CARREGAR PÁGINA
        listarUsuarios();
        listarEventos();
        listarEscalas();

        // FORMULÁRIO DE INSCRIÇÃO
        const form = document.getElementById('formInscricao');
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const id_usuario = document.getElementById('id_usuario').value;
            const id_evento = document.getElementById('id_evento').value;

            fetch('http://localhost:3000/inscrever_evento', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id_usuario, id_evento })
            })
            .then(res => res.text())
            .then(msg => {
                alert(msg);
                listarEventos(); // atualizar lista se necessário
            })
            .catch(err => console.error('Erro:', err));
        });
    </script>
</body>
</html>
